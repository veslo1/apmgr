<?php
/**
 * Test class for User_Library_Helper_Join.
 * Generated by PHPUnit on 2010-10-24 at 00:17:47.
 * @author Jorge Omar Vazquez <jvazquez@debserverp4.com.ar>
 */
class User_Library_Helper_JoinTest extends ControllerTestCase
{

    /* (non-PHPdoc)
     * @see tests/application/ControllerTestCase::setUp()
     */
    public function setUp()
    {
    	parent::setUp();
    	$this->dataSetStackBuffer = array('users'=>1);
		$this->loadDataSets();
    }

    /* (non-PHPdoc)
     * @see tests/application/ControllerTestCase::tearDown()
     */
    public function tearDown()
    {
    	$this->unLoadDataSets();
    	parent::tearDown();
    }

    public function testCreateAccount()
    {
    	
    	$args = array('username'=>'john','firstName'=>'Test','lastName'=>'Test','password'=>'Test1234','emailAddress'=>'jtest@test.com');
    	$user = new User_Library_Helper_Join($args);
    	$id = $user->createAccount();
    	$this->assertTrue($id!=false,$user->getMessageState());
    }

    public function testCreateAccountRejectsRepeatedName()
    {
    	
    	$args = array('username'=>'jvazquez','firstName'=>'Test','lastName'=>'Test','password'=>'Test1234','emailAddress'=>'jtest@test.com');
    	$user = new User_Library_Helper_Join($args);
    	$id = $user->createAccount();
    	$this->assertFalse($id!=false,'Create account operation failed');
    	$this->assertEquals('usernameExists', $user->getMessageState());
    }

    public function testAuthenticate()
    {
    	
    	$args = array('username'=>'john','firstName'=>'Test','lastName'=>'Test','password'=>'Test1234','emailAddress'=>'jtest@test.com');
    	$user = new User_Library_Helper_Join($args);
    	$id = $user->createAccount();
    	$this->assertTrue($id!=false,'Create account operation failed');
    	$authenticated = $user->authenticate(false, $id);
    	$this->assertTrue($authenticated,'Authenticate operation failed');
    }
}
?>
