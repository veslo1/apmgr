<?php
/**
 * Test class for User_Library_Helper_Login.
 * Generated by PHPUnit on 2010-10-23 at 16:53:51.
 * @author Jorge Omar Vazquez <jvazquez@debserverp4.com.ar>
 */
class User_Library_Helper_LoginTest extends ControllerTestCase {
	/**
	 * @var User_Library_Helper_Login
	 */
	protected $object;

	/**
	 * Sets up the fixture, for example, opens a network connection.
	 * This method is called before a test is executed.
	 */
	public function setUp()
	{
		parent::setUp();
		$this->dataSetStackBuffer = array('users'=>1);
		$this->loadDataSets();
		$this->object = new User_Library_Helper_Login;
	}

	/**
	 * Tears down the fixture, for example, closes a network connection.
	 * This method is called after a test is executed.
	 */
	public function tearDown()
	{
		$this->unLoadDataSets();
		parent::tearDown();
	}

	public function testGetLoginDestination()
	{
		
		$args = array(0=>0,1=>1,2=>NULL);
		$result = $this->object->getLoginDestination($args[0]);
		$this->assertEquals('user/login/index',$result,'We should be going back to login when we fail');
		$result = $this->object->getLoginDestination($args[1]);
		$this->assertEquals('default/index/index', $result,'With a positive seed, we should go to index');
		$result = $this->object->getLoginDestination($args[2]);
		$this->assertEquals('user/login/index', $result,'With a null seed, we should be sent to login');
	}

	public function testAuthenticateUser()
	{
		
		$result = $this->object->authenticateUser('jvazquez', 'Test1234');
		$this->assertTrue($result,$this->object->getMessageState());
		$this->logout();
	}

	public function testAuthenticateUserFails()
	{
		
		$result = $this->object->authenticateUser('jvazquez',null);
		$this->assertFalse($result,'Should have returned false');
		$this->assertEquals('invalidCredentials', $this->object->getMessageState());
	}
}
?>
